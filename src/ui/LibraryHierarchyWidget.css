/* Library Hierarchy Widget Styles */

.library-hierarchy-widget {
    width: 100%;
    height: 100vh;
    display: flex;
    flex-direction: column;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

.library-hierarchy-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background-color: #f5f5f5;
    border-bottom: 1px solid #ddd;
}

.library-hierarchy-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: #333;
}

.btn-save {
    padding: 8px 16px;
    background-color: #0080ff;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
}

.btn-save:hover {
    background-color: #0066cc;
}

.btn-save:active {
    background-color: #0052a3;
}

.bpmn-library-container {
    flex: 1;
    position: relative;
    overflow: hidden;
}

/* BPMN.js default styles override */
.bpmn-library-container .djs-container {
    background-color: #fafafa !important;
}

/* Custom library icon in palette */
.library-icon::before {
    content: "ðŸ“š";
    font-size: 20px;
}

/* Library element styling */
.library-icon-group {
    pointer-events: none;
}

/* Hover effect for library elements */
.djs-element.hover .djs-outline {
    stroke: #4A90E2 !important;
    stroke-width: 3px !important;
}

/* Selected library element */
.djs-element.selected .djs-outline {
    stroke: #0080ff !important;
    stroke-width: 3px !important;
}

/* Custom palette styling */
.djs-palette {
    background: #ffffff;
    border-right: 1px solid #ddd;
}

.djs-palette .entry {
    color: #333;
}

.djs-palette .entry:hover {
    background-color: #f0f0f0;
}

/* Connection styling for library hierarchy */
[data-element-id] > .djs-visual > path {
    stroke: #4A90E2;
    stroke-width: 2px;
}

[data-element-id] > .djs-visual > path:hover {
    stroke: #0080ff;
    stroke-width: 3px;
}

/* Library label styling */
.djs-label {
    font-family: Arial, sans-serif;
    font-size: 12px;
    font-weight: 500;
    fill: #333;
}

/* Context pad styling */
.djs-context-pad {
    background: white;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.djs-context-pad .entry:hover {
    background-color: #f0f0f0;
}

/* Minimap styling (if enabled) */
.djs-minimap {
    border: 1px solid #ddd;
    background: white;
}

/* Loading state */
.library-hierarchy-widget.loading {
    opacity: 0.6;
    pointer-events: none;
}

/* Error state */
.library-hierarchy-error {
    padding: 20px;
    text-align: center;
    color: #d32f2f;
    background-color: #ffebee;
    border: 1px solid #ef5350;
    border-radius: 4px;
    margin: 16px;
}

/* Read-only mode */
.library-hierarchy-widget[data-readonly="true"] .djs-palette,
.library-hierarchy-widget[data-readonly="true"] .djs-context-pad {
    display: none !important;
}

/* Hide unwanted palette tools */
.bpmn-library-container .djs-palette .entry[data-action="create.start-event"],
.bpmn-library-container .djs-palette .entry[data-action="create.intermediate-event"],
.bpmn-library-container .djs-palette .entry[data-action="create.end-event"],
.bpmn-library-container .djs-palette .entry[data-action="create.exclusive-gateway"],
.bpmn-library-container .djs-palette .entry[data-action="create.parallel-gateway"],
.bpmn-library-container .djs-palette .entry[data-action="create.task"],
.bpmn-library-container .djs-palette .entry[data-action="create.data-object"],
.bpmn-library-container .djs-palette .entry[data-action="create.data-store"],
.bpmn-library-container .djs-palette .entry[data-action="create.subprocess-expanded"],
.bpmn-library-container .djs-palette .entry[data-action="create.participant-expanded"],
.bpmn-library-container .djs-palette .entry[data-action="create.group"] {
    display: none !important;
}

/* Also hide their separators if they become orphaned */
.bpmn-library-container .djs-palette .separator:empty {
    display: none !important;
}


.djs-palette.two-column.open {
    width: 60px !important;
}

/* Palette Header */
.bpmn-library-container .djs-palette {
    width: 80px !important;
}

.bpmn-library-container .djs-palette::before {
    content: "Toolkit";
    display: block;
    padding: 12px 8px;
    font-weight: 600;
    font-size: 14px;
    color: #333;
    border-bottom: 1px solid #ddd;
    background: #f8f9fa;
}

/* Style palette entries to show labels */
.bpmn-library-container .djs-palette .entry {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    padding: 8px 4px !important;
    height: auto !important;
    min-height: 60px !important;
}

.bpmn-library-container .djs-palette .entry::after {
    content: attr(title);
    display: block;
    font-size: 11px;
    color: #666;
    margin-top: 4px;
    text-align: center;
    line-height: 1.2;
}

/* Adjust icon size */
.bpmn-library-container .djs-palette .entry [class*="bpmn-icon"] {
    font-size: 24px !important;
}

/* Custom Library Icon */
.bpmn-library-container .djs-palette .entry[data-action="create.library"]::before {
    content: "ðŸ“š";
    font-size: 24px;
    display: block;
}


/* ========================================
   Remove Subprocess Markers (Plus Icon & Blue Arrow)
   ======================================== */

/* Hide the plus icon (expand/collapse marker) */
.bpmn-library-container [data-marker="sub-process-marker"] {
    display: none !important;
}

/* Hide the blue navigation arrow at bottom-right */
.djs-overlay-drilldown {
    display: none !important;
}

/* ========================================
   Context Pad - Keep Only Delete & Connect
   ======================================== */

/* Hide all context pad entries by default */
.bpmn-library-container .djs-context-pad .entry {
    display: none !important;
}

/* Show only delete and connect */
.bpmn-library-container .djs-context-pad .entry[data-action="delete"],
.bpmn-library-container .djs-context-pad .entry[data-action="connect"] {
    display: block !important;
}

/* Also hide the append/replace entries if they show up */
.bpmn-library-container .djs-context-pad .entry[data-action^="append"],
.bpmn-library-container .djs-context-pad .entry[data-action^="replace"] {
    display: none !important;
}

/* Remove the plus icon marker more aggressively */
.bpmn-library-container [data-marker="sub-process-marker"],
.bpmn-library-container g[data-marker="sub-process-marker"],
.bpmn-library-container path[data-marker="sub-process-marker"],
.bpmn-library-container rect[data-marker="sub-process-marker"] {
    display: none !important;
    visibility: hidden !important;
}

/* Remove any SVG path that contains the plus icon pattern */
.bpmn-library-container .djs-element[data-element-id*="SubProcess"] path[d*="M122.5"] {
    display: none !important;
}

/* Hide the subprocess marker specifically */
.bpmn-library-container .djs-visual > g > path[fill="white"][stroke="rgb(34, 36, 42)"] {
    display: none !important;
}

/* Remove the subprocess marker square (the empty box where plus icon was) */
.bpmn-library-container .djs-visual > g > rect[width="14"][height="14"] {
    display: none !important;
}

/* More specific - target white filled small rectangles */
.bpmn-library-container .djs-visual > g > rect[width="14"][height="14"][fill="white"] {
    display: none !important;
}

/* Also hide any rect with stroke rgb(34, 36, 42) and small size */
.bpmn-library-container .djs-visual rect[width="14"][height="14"][rx="0"] {
    display: none !important;
}

/* Target by transform attribute if it has the marker position */
.bpmn-library-container .djs-visual > g > rect[transform*="122.5"] {
    display: none !important;
}

/* Button container */
.header-buttons {
    display: flex;
    gap: 8px;
}

/* Download button styling */
.btn-download {
    padding: 8px 16px;
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
}

.btn-download:hover {
    background-color: #218838;
}

.btn-download:active {
    background-color: #1e7e34;
}

/* Update existing btn-save if needed */
.btn-save {
    padding: 8px 16px;
    background-color: #0080ff;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .library-hierarchy-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
    }

    .btn-save {
        width: 100%;
    }
}